image: "presslabs/zinc:kub_compat"
imagePullPolicy: "Always"

config:
  debug: false
  secretKey: ""

  envName: "staging"
  redisUrl: redis://zinc-redis:6379/

  dbHost: zinc-mysql
  dbEngine: django.db.backends.mysql

  socialAuthKey: ""
  socialAuthSecrete: ""

  latticeUser: ""
  latticePassword: ""

  awsKey: ""
  awsSecrete: ""

  sentryDSN: ""

  allowedHosts: [".stage.presslabs.net", ".presslabs.net"]


web:
  replicatCount: 1
  resources:
    requests:
      memory: 128Mi
  service:
    internalPort: 8000
    externalPort: 80


beat:
  resources: {}

worker:
  replicaCount: 1


mysql:
  enabled: true

  mysqlUser: zinc
  mysqlPassword: ""
  mysqlDatabase: zinc

  configurationFiles:
    mysql.cnf: |-
      [client]
      default-character-set = utf8mb4

      [mysql]
      default-character-set = utf8mb4

      [mysqld]
      character-set-server = utf8mb4
      collation-server = utf8mb4_unicode_ci
      skip-name-resolve

redis:
  enabled: true
  usePassword: false  # remove an set password when https://github.com/kubernetes/charts/issues/1857 gets fixed
  metrics:
    enabled: true
  args:
    - "redis-server"
    - "--protected-mode no"  # remove when usePassword: true
    - "--maxmemory-policy volatile-ttl"
    - "--maxmemory 256mb"
    - "--save 300 1"
    - "--save 60 10000"
    - "--appendonly yes"

ingress:
  enabled: true
  hosts:
    - zinc2.stage.presslabs.net
  annotations:
    kubernetes.io/ingress.class: nginx
    kubernetes.io/tls-acme: true
  tls:
    # - secreteName: zinc-tls
    #   hosts:
    #     - zinc2.stage.presslabs.net
